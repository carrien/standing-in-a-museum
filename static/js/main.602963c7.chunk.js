(this.webpackJsonpsitting=this.webpackJsonpsitting||[]).push([[0],{11:function(e,t,n){},12:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(3),o=n.n(i),c=(n(11),n(4)),u=n(1),s=(n(5),Array(10).fill(0).map((function(e,t){return t.toString().padStart(2,"0")})).map((function(e){return"sitting/sitting.".concat(e,".mp3")})).map((function(e,t){return{url:e,durationMs:0,gallery:"coat-closet",iteration:t,sequence:0,arrayBuffer:null}})));function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(n,!0).forEach((function(t){Object(u.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=.1,g=.2;function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(n,!0).forEach((function(t){Object(u.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b=new(window.AudioContext||window.webkitAudioContext),y={progress:[],audioContextStatus:b.state,playbackStatus:{}},h=function(e,t){switch(t.type){case"beginPlayback":return m({},e,{audioContextStatus:b.state});case"downloadStatus":return m({},e,{progress:t.progress});case"playbackStatus":return m({},e,{playbackStatus:t.status});default:return e}},O=function(){var e=Object(r.useReducer)(h,y),t=Object(c.a)(e,2),n=t[0],i=t[1],o=n.progress.filter((function(e){return e.finished})).length,u=n.progress.length,l=Object(r.useRef)((function(e){}));Object(r.useEffect)((function(){!function(e,t){var n=e.map((function(e){return{started:!1,finished:!1,target:e}}))}(s)}),[]),Object(r.useEffect)((function(){if(!(n.progress.filter((function(e){return e.finished})).length<s.length)){var e=n.progress.map((function(e){return e.target})),t=function(e,t,n){var r=1+Math.max.apply(null,t.map((function(e){return e.iteration}))),a=[],i=function(t){var n=e.createBufferSource();n.buffer=t.audioBuffer;var r=e.createGain();return n.connect(r),r.connect(e.destination),r.gain.setValueAtTime(1e-8,t.startTime),r.gain.exponentialRampToValueAtTime(.999,t.startTime+p),n.start(t.startTime,t.offset),{bufferDuration:t.audioBuffer.duration,logicalStartTime:t.startTime,media:t.segment,node:n,gainNode:r}},o=null,c=null,u=function(n){c&&c.node.disconnect();var o,u=a.slice(-1)[0],s=u.logicalStartTime+u.bufferDuration,l=t.filter((o=u.media,function(e){var t=(o.iteration+1)%r;return e.iteration===t&&e.gallery===o.gallery}))[0],f=l.arrayBuffer;f=f.slice(0,f.byteLength),e.decodeAudioData(f,(function(e){var t=i({segment:l,startTime:s,offset:0,audioBuffer:e});c=t;var n=a;u.node.addEventListener("ended",(function(){n===a&&(a=[t],c=null)}))}),(function(e){console.log("Decode err",e)}))};return setInterval((function(){if(o&&0!==a.length){var t=a.slice(-1)[0].media;t.iteration!==o.iteration&&(o={gallery:o.gallery,iteration:t.iteration,offset:0},u()),n(f({},o,{offset:e.currentTime-a[0].logicalStartTime}))}}),1e3*g),{dispatch:function(n){if("change-iteration"===n.type&&(!o||o.iteration!==n.iteration)){var r=t.filter((function(e){return e.iteration===n.iteration}))[0],c=r.arrayBuffer;c=c.slice(0,c.byteLength),e.decodeAudioData(c,(function(t){var c=a.length?e.currentTime-a.slice(-1)[0].logicalStartTime:0,s=e.currentTime+.1,l=i({segment:r,startTime:s,offset:c,audioBuffer:t});a.forEach((function(e){e.gainNode.gain.setValueAtTime(.9999,s),e.gainNode.gain.exponentialRampToValueAtTime(1e-5,s+3*p)})),a=[{node:l.node,gainNode:l.gainNode,logicalStartTime:e.currentTime-c,bufferDuration:t.duration,media:r}];var g={iteration:n.iteration,gallery:"first-floor"};u(),o=f({},g,{offset:0})}),(function(e){console.log("Decode err",e)}))}}}}(b,e,(function(e){return i({type:"playbackStatus",status:e})}));l.current=t.dispatch}}),[n.progress]);return a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"App-header"},a.a.createElement("button",{onClick:function(){return console.log("Starting audio",b),void b.resume().then((function(){i({type:"beginPlayback"})}))}},"Begin Playback"),"running"===n.audioContextStatus&&s.map((function(e){return a.a.createElement("button",{key:e.iteration,onClick:function(){return l.current({type:"change-iteration",iteration:e.iteration})}},e.iteration)})),a.a.createElement("pre",null,o," of ",u," files loaded.",n.audioContextStatus),a.a.createElement("br",null),a.a.createElement("pre",null,JSON.stringify(n.playbackStatus,null,2))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},6:function(e,t,n){e.exports=n(12)}},[[6,1,2]]]);
//# sourceMappingURL=main.602963c7.chunk.js.map